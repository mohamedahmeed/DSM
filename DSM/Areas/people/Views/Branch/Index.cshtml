@using DSM.TABLES
@model DSM.DTO.resultDTO
@{
    ViewData["Title"] = "Index";
}
<h1>Index</h1>
<p>
    <a href="http://localhost:4540/people/branch/Add">Create New</a>
</p>
<table class="table" id="tbl">
    <thead>
        <tr>            
            <th>
                Name
            </th>
            <th>
               CreatedDate
            </th>
             <th>
                IsActive
            </th>
            <th>
               Poster
            </th>
           
            <th></th>
             <th></th>
              <th></th>
        </tr>
    </thead>
  
    </table>
    @section Scripts{
        <script>

            
            $(document).ready(function () {
    $("#tbl").DataTable({
        "processing": true,
        "serverSide": true,
        "filter": true,
        "ajax": {
            "url": "http://localhost:4540/people/branch/getDataTable",
            "type": "POST",
            "datatype": "json"
        },
       
        "columns": [
           
            { "data": "name", "name": "Name", "autoWidth": true },
            { "data": "createdDate", "name": "CreatedDate", "autoWidth": true },
            { "data": "isActive", "name": "IsActive","type":"CheckBox", "autoWidth": true ,
             render: function (data,type,row) {
                          if (data == true) {
                            return '<input onChange="Modify('+data.+','+data.isActive+')" type="checkbox" checked>';
                          } else {
                            return '<input onChange="Modify('+row.iD+','+data.isActive+')" type="checkbox">';
                          }
                        return data;
                      }  
                     
            },
            { "data": "poster", "name": "poster", "autoWidth": true },
           

            {
                "render": function (data,row) { return "<a href='#' class='btn btn-info' onclick=del('" + row.id+ "'); >Details</a>";   }
            },
            {
                 "render": function (data,row) { return "<a href='#' class='btn btn-dark' onclick=Modify('" + row.id+ "'); >Edit</a>";   },
            },
            {
                  "render": function (data,row) { return "<a href='#' class='btn btn-danger' onclick=del('" + row.id+ "'); >Delete</a>";   }
            }
        ]
    });
});  



            function del(h){
                //var c=confirm("Are You sure You Want To Delete");
                //if(!c){
                //return event.preventDefault();
                alert(h);
                 
                }
           

            function Modify(va,r){
              //var r=  window.confirm("Are You sure !!!1")
              //if(r){
              console.log(r)
              var x;
              if(r=="True"){
                   x=false;
              }
              else {
                  x=true
              }
              console.log(x)
                  $.ajax({
                     
                    method: 'post',
                    data:{'d':x},
                    url: 'http://localhost:4540/people/Branch/EditChecked/'+va,
                                      
                    success:function(res)
                    {
                        if (res.status)
                        {
                            alertify.success(res.message);
                            setTimeout(function(){
                                  window.location.href = "http://localhost:4540/people/Branch/Index";
                            }, 3000);

                        }
                        else
                        {
                            alertify.error(res.message);
                        }

                    },
                         error: function (res)
                         {
                        alertify.error( res.message);
                    }

                }); 
            //  }
            }
           
        </script>
    }
 
